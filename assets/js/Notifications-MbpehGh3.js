import{_ as h,a as n,o as r,b as t,d as c,s as f,v as m,y as _,F as b,r as v,n as p,t as l,E as u}from"./index-DSpDc2Ld.js";const y={name:"Notifications",data(){return{notifications:[],search:"",filterIsRead:"",currentPage:1,totalPages:1,pageSize:10,successMessage:"",errorMessage:""}},methods:{async loadNotifications(a=1){try{const e={page:a,page_size:this.pageSize};this.search&&(e.search=this.search),this.filterIsRead!==""&&(e.is_read=this.filterIsRead);const d=await u.get("/api/v1/notifications/notifications/",{params:e});this.notifications=d.data.results,this.totalPages=Math.ceil(d.data.count/this.pageSize),this.currentPage=a}catch(e){this.errorMessage="Failed to load notifications.",console.error(e)}},async markAsRead(a){try{await u.patch(`/api/v1/notifications/notifications/${a}/`,{is_read:!0}),this.successMessage="Notification marked as read!",this.loadNotifications(this.currentPage)}catch(e){this.errorMessage="Failed to mark as read.",console.error(e)}},async deleteNotification(a){if(confirm("Are you sure you want to delete this notification?"))try{await u.delete(`/api/v1/notifications/notifications/${a}/`),this.successMessage="Notification deleted!",this.loadNotifications(this.currentPage)}catch(e){this.errorMessage="Failed to delete notification.",console.error(e)}},changePage(a){a<1||a>this.totalPages||this.loadNotifications(a)},formatDate(a){return a?new Date(a).toLocaleString():"-"}},mounted(){this.loadNotifications()}},k={class:"container py-5"},N={class:"row mb-3"},P={class:"col-md-6 mb-2"},M={class:"col-md-6 mb-2"},x={class:"list-group"},w={class:"mb-1"},C={class:"mb-1"},R={key:0},D=["href"],I={class:"text-muted"},S={class:"d-flex flex-column align-items-end"},z=["onClick"],F=["onClick"],V={key:0,class:"text-center py-4"},A={"aria-label":"Page navigation",class:"mt-3 d-flex justify-content-between align-items-center"},B=["disabled"],U=["disabled"],j={key:0,class:"alert alert-success mt-3"},E={key:1,class:"alert alert-danger mt-3"};function L(a,e,d,T,i,o){return r(),n("div",k,[e[8]||(e[8]=t("h1",{class:"mb-4"},"Notifications",-1)),t("div",N,[t("div",P,[f(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>i.search=s),onInput:e[1]||(e[1]=(...s)=>o.loadNotifications&&o.loadNotifications(...s)),type:"text",class:"form-control",placeholder:"Search notifications..."},null,544),[[m,i.search]])]),t("div",M,[f(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>i.filterIsRead=s),onChange:e[3]||(e[3]=(...s)=>o.loadNotifications&&o.loadNotifications(...s)),class:"form-select"},[...e[6]||(e[6]=[t("option",{value:""},"All",-1),t("option",{value:!0},"Read",-1),t("option",{value:!1},"Unread",-1)])],544),[[_,i.filterIsRead]])])]),t("div",x,[(r(!0),n(b,null,v(i.notifications,s=>(r(),n("div",{key:s.id,class:p(["list-group-item","d-flex","justify-content-between",s.is_read?"":"list-group-item-warning"])},[t("div",null,[t("h6",w,l(s.title),1),t("p",C,l(s.message),1),s.link?(r(),n("small",R,[t("a",{href:s.link,target:"_blank"},"View Details",8,D)])):c("",!0),e[7]||(e[7]=t("br",null,null,-1)),t("small",I,l(o.formatDate(s.created_at)),1)]),t("div",S,[s.is_read?c("",!0):(r(),n("button",{key:0,onClick:g=>o.markAsRead(s.id),class:"btn btn-sm btn-primary mb-1"}," Mark as Read ",8,z)),t("button",{onClick:g=>o.deleteNotification(s.id),class:"btn btn-sm btn-danger"}," Delete ",8,F)])],2))),128)),i.notifications.length===0?(r(),n("div",V," No notifications found. ")):c("",!0)]),t("nav",A,[t("button",{class:"btn btn-outline-secondary",onClick:e[4]||(e[4]=s=>o.changePage(i.currentPage-1)),disabled:i.currentPage===1},"Previous",8,B),t("span",null,"Page "+l(i.currentPage)+" of "+l(i.totalPages),1),t("button",{class:"btn btn-outline-secondary",onClick:e[5]||(e[5]=s=>o.changePage(i.currentPage+1)),disabled:i.currentPage===i.totalPages},"Next",8,U)]),i.successMessage?(r(),n("div",j,l(i.successMessage),1)):c("",!0),i.errorMessage?(r(),n("div",E,l(i.errorMessage),1)):c("",!0)])}const G=h(y,[["render",L],["__scopeId","data-v-62c328a8"]]);export{G as default};
