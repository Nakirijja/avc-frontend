import{_ as j,i as Y,a as i,o as d,b as t,j as x,w as k,m as n,t as l,d as m,n as Z,F as w,r as q,k as Q,l as G,A as J,B as K,e as b,c as R,f as X,p as E,x as V}from"./index-DSpDc2Ld.js";var D={};const $={name:"EventDetail",setup(){const p=J(),e=K(),r=b(null),a=b(!0),_=b(!1),y=b(null),u=b(null),c=async()=>{a.value=!0,y.value=null;try{const s=p.params.id,o=await E.events.getEvent(s);r.value=o.data,await h()}catch(s){console.error("Error loading event:",s),y.value="Unable to load event details. Please try again."}finally{a.value=!1}},h=async()=>{if(!V.isAuthenticated()){u.value=null;return}try{const s=p.params.id,o=await E.events.getUserRSVP(s);u.value=o.data}catch(s){s.response?.status===404?u.value=null:console.error("Error checking RSVP:",s)}},T=s=>{if(!s.date)return"Date to be announced";try{return new Date(s.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}catch{return s.date}},I=s=>{if(!s)return"";try{return new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}catch{return s}},A=s=>s.start_time&&s.end_time?`${S(s.start_time)} - ${S(s.end_time)}`:s.time?s.time:"Time to be announced",S=s=>{if(!s)return"";try{const[o,v]=s.split(":"),f=parseInt(o),g=f>=12?"PM":"AM";return`${f%12||12}:${v} ${g}`}catch{return s}},M=s=>s?s.split(`
`).filter(v=>v.trim()!=="").map(v=>`<p>${v}</p>`).join(""):"No description available",L=s=>({practice:"Practice",rehearsal:"Rehearsal",performance:"Performance",meeting:"Meeting",workshop:"Workshop",social:"Social Event"})[s]||s,U=s=>({upcoming:"Upcoming",ongoing:"Ongoing",completed:"Completed",cancelled:"Cancelled"})[s]||s,H=s=>s?s.startsWith("http")?s:s.startsWith("/media/")?`${D.VUE_APP_API_URL||"http://localhost:8000"}${s}`:`${D.VUE_APP_API_URL||"http://localhost:8000"}/media/${s}`:"https://picsum.photos/800/400?random=1",N=s=>({upcoming:"bg-success",ongoing:"bg-warning text-dark",completed:"bg-secondary",cancelled:"bg-danger"})[s]||"bg-primary",z=s=>{if(!s.max_attendees||s.max_attendees===0)return 0;const o=s.rsvp_count||0;return Math.min(100,o/s.max_attendees*100)},P=s=>{if(!s.max_attendees||s.max_attendees===0)return"Unlimited";const o=s.rsvp_count||0;return Math.max(0,s.max_attendees-o)},B=R(()=>!r.value||r.value.status!=="upcoming"||C.value?!1:r.value.max_attendees===0?!0:P(r.value)>0),C=R(()=>!!u.value),F=async()=>{if(!V.isAuthenticated()){e.push({path:"/auth/login",query:{redirect:p.fullPath}});return}_.value=!0;try{const s={event:r.value.id,guests:1,notes:""},o=await E.events.rsvpToEvent(r.value.id,s);u.value=o.data,r.value.rsvp_count=(r.value.rsvp_count||0)+1,alert("RSVP successful! We look forward to seeing you.")}catch(s){console.error("RSVP error:",s);let o="Unable to RSVP. Please try again.";s.response&&(s.response.status===400?o=s.response.data.detail||"Invalid RSVP data.":s.response.status===409?(o="You have already RSVPed to this event.",u.value={id:"existing"}):s.response.status===403&&(o="Event is full or registration is closed.")),alert(o)}finally{_.value=!1}},O=()=>{navigator.share?navigator.share({title:r.value.title,text:r.value.description,url:window.location.href}):(navigator.clipboard.writeText(window.location.href),alert("Event link copied to clipboard!"))},W=()=>{if(!(!r.value||!r.value.date))try{const s=new Date(r.value.date);if(r.value.start_time){const[f,g]=r.value.start_time.split(":");s.setHours(parseInt(f),parseInt(g))}const o=new Date(s);if(r.value.end_time){const[f,g]=r.value.end_time.split(":");o.setHours(parseInt(f),parseInt(g))}else o.setHours(s.getHours()+2);const v=`https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(r.value.title)}&dates=${s.toISOString().replace(/[-:]/g,"").split(".")[0]+"Z"}/${o.toISOString().replace(/[-:]/g,"").split(".")[0]+"Z"}&details=${encodeURIComponent(r.value.description)}&location=${encodeURIComponent(r.value.location)}`;window.open(v,"_blank")}catch(s){console.error("Calendar error:",s),alert("Unable to create calendar event. Please try manually.")}};return X(()=>{c()}),{event:r,loading:a,rsvping:_,error:y,formatEventDate:T,formatShortDate:I,formatEventTime:A,formatDescription:M,formatEventType:L,formatEventStatus:U,getEventImage:H,getStatusClass:N,getAttendancePercentage:z,getRemainingSpots:P,canRSVP:B,hasRSVPed:C,submitRSVP:F,shareEvent:O,addToCalendar:W}}},tt={class:"event-detail-page"},et={"aria-label":"breadcrumb",class:"container py-3"},st={class:"breadcrumb"},at={class:"breadcrumb-item"},nt={class:"breadcrumb-item"},ot={class:"breadcrumb-item active","aria-current":"page"},rt={class:"container py-4"},lt={key:0,class:"text-center py-5"},it={key:1,class:"alert alert-danger text-center"},dt={class:"mb-0"},ct={key:2,class:"row"},mt={class:"col-lg-8"},ut={class:"event-header mb-4"},vt={class:"event-badges mb-3"},ft={class:"badge bg-primary me-2"},gt={key:0,class:"badge bg-warning text-dark ms-2"},bt={class:"event-title mb-3"},pt={class:"event-meta d-flex flex-wrap gap-3 mb-4"},_t={class:"meta-item"},yt={class:"meta-item"},ht={class:"meta-item"},xt={key:0,class:"meta-item"},kt={key:0,class:"mb-4"},wt={class:"event-image-container rounded overflow-hidden shadow"},Et=["src","alt"],St={class:"card mb-4 shadow-sm"},Pt={class:"card-body"},Ct=["innerHTML"],Rt={key:0,class:"mt-4"},Vt={class:"mb-0"},Dt={key:1,class:"mt-4 p-3 bg-light rounded"},Tt={class:"mb-0"},It={key:1,class:"card mb-4 shadow-sm"},At={class:"card-body"},Mt={class:"timeline"},Lt={class:"timeline-time"},Ut={class:"timeline-content"},Ht={class:"mb-1"},Nt={key:0,class:"mb-0 text-muted"},zt={key:2,class:"card shadow-sm"},Bt={class:"card-body"},Ft=["innerHTML"],Ot={class:"col-lg-4"},Wt={class:"card mb-4 shadow-sm"},jt={class:"card-body text-center"},Yt={key:0,class:"mb-4"},Zt={class:"progress mb-2",style:{height:"10px"}},qt={class:"text-muted"},Qt=["disabled"],Gt={key:2,class:"btn btn-success btn-lg w-100 mb-3",disabled:""},Jt={key:3,class:"btn btn-secondary btn-lg w-100 mb-3",disabled:""},Kt={class:"d-grid gap-2"},Xt={class:"card mb-4 shadow-sm"},$t={class:"card-body"},te={class:"organizer-info"},ee={class:"d-flex align-items-center mb-3"},se={class:"mb-1"},ae={class:"card shadow-sm"},ne={class:"card-body"},oe={class:"list-unstyled mb-0"},re={class:"mb-2"},le={class:"mb-2"},ie={class:"mb-2"},de={key:0,class:"mb-2"};function ce(p,e,r,a,_,y){const u=Y("router-link");return d(),i("div",tt,[t("nav",et,[t("ol",st,[t("li",at,[x(u,{to:"/",class:"text-decoration-none"},{default:k(()=>[...e[3]||(e[3]=[t("i",{class:"fas fa-home me-1"},null,-1),n("Home ",-1)])]),_:1})]),t("li",nt,[x(u,{to:"/events",class:"text-decoration-none"},{default:k(()=>[...e[4]||(e[4]=[n("Events",-1)])]),_:1})]),t("li",ot,l(a.event?a.event.title:"Event Details"),1)])]),t("div",rt,[a.loading?(d(),i("div",lt,[...e[5]||(e[5]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"mt-3 text-muted"},"Loading event details...",-1)])])):a.error?(d(),i("div",it,[e[7]||(e[7]=t("i",{class:"fas fa-exclamation-triangle me-2"},null,-1)),e[8]||(e[8]=t("strong",null,"Unable to load event",-1)),t("p",dt,l(a.error),1),x(u,{to:"/events",class:"btn btn-primary mt-2"},{default:k(()=>[...e[6]||(e[6]=[t("i",{class:"fas fa-arrow-left me-1"},null,-1),n(" Back to Events ",-1)])]),_:1})])):a.event?(d(),i("div",ct,[t("div",mt,[t("div",ut,[t("div",vt,[t("span",ft,l(a.formatEventType(a.event.type)),1),t("span",{class:Z(["badge",a.getStatusClass(a.event.status)])},l(a.formatEventStatus(a.event.status)),3),a.event.is_featured?(d(),i("span",gt,[...e[9]||(e[9]=[t("i",{class:"fas fa-star me-1"},null,-1),n("Featured ",-1)])])):m("",!0)]),t("h1",bt,l(a.event.title),1),t("div",pt,[t("div",_t,[e[10]||(e[10]=t("i",{class:"fas fa-calendar-alt me-2 text-primary"},null,-1)),e[11]||(e[11]=t("strong",null,"Date:",-1)),n(" "+l(a.formatEventDate(a.event)),1)]),t("div",yt,[e[12]||(e[12]=t("i",{class:"fas fa-clock me-2 text-primary"},null,-1)),e[13]||(e[13]=t("strong",null,"Time:",-1)),n(" "+l(a.formatEventTime(a.event)),1)]),t("div",ht,[e[14]||(e[14]=t("i",{class:"fas fa-map-marker-alt me-2 text-primary"},null,-1)),e[15]||(e[15]=t("strong",null,"Location:",-1)),n(" "+l(a.event.location),1)]),a.event.max_attendees>0?(d(),i("div",xt,[e[16]||(e[16]=t("i",{class:"fas fa-users me-2 text-primary"},null,-1)),e[17]||(e[17]=t("strong",null,"Capacity:",-1)),n(" "+l(a.event.max_attendees)+" people ",1)])):m("",!0)])]),a.event.image?(d(),i("div",kt,[t("div",wt,[t("img",{src:a.getEventImage(a.event.image),alt:a.event.title,class:"img-fluid w-100",style:{"max-height":"400px","object-fit":"cover"}},null,8,Et)])])):m("",!0),t("div",St,[t("div",Pt,[e[20]||(e[20]=t("h3",{class:"card-title mb-3"},[t("i",{class:"fas fa-info-circle me-2 text-primary"}),n(" Event Description ")],-1)),t("div",{class:"event-description",innerHTML:a.formatDescription(a.event.description)},null,8,Ct),a.event.location_details?(d(),i("div",Rt,[e[18]||(e[18]=t("h5",{class:"mb-3"},[t("i",{class:"fas fa-map-pin me-2 text-primary"}),n(" Location Details ")],-1)),t("p",Vt,l(a.event.location_details),1)])):m("",!0),a.event.location_notes?(d(),i("div",Dt,[e[19]||(e[19]=t("h6",{class:"mb-2"},[t("i",{class:"fas fa-exclamation-circle me-2 text-warning"}),n(" Important Notes ")],-1)),t("p",Tt,l(a.event.location_notes),1)])):m("",!0)])]),a.event.schedule&&a.event.schedule.length>0?(d(),i("div",It,[t("div",At,[e[21]||(e[21]=t("h3",{class:"card-title mb-3"},[t("i",{class:"fas fa-list-alt me-2 text-primary"}),n(" Event Schedule ")],-1)),t("div",Mt,[(d(!0),i(w,null,q(a.event.schedule,(c,h)=>(d(),i("div",{key:h,class:"timeline-item"},[t("div",Lt,l(c.time),1),t("div",Ut,[t("h5",Ht,l(c.title),1),c.description?(d(),i("p",Nt,l(c.description),1)):m("",!0)])]))),128))])])])):m("",!0),a.event.additional_notes?(d(),i("div",zt,[t("div",Bt,[e[22]||(e[22]=t("h3",{class:"card-title mb-3"},[t("i",{class:"fas fa-sticky-note me-2 text-primary"}),n(" Additional Information ")],-1)),t("div",{class:"additional-notes",innerHTML:a.formatDescription(a.event.additional_notes)},null,8,Ft)])])):m("",!0)]),t("div",Ot,[t("div",Wt,[t("div",jt,[e[32]||(e[32]=t("h5",{class:"card-title mb-4"},[t("i",{class:"fas fa-calendar-check me-2 text-primary"}),n(" Attend this Event ")],-1)),a.event.max_attendees>0?(d(),i("div",Yt,[t("div",Zt,[t("div",{class:"progress-bar bg-success",style:Q({width:`${a.getAttendancePercentage(a.event)}%`})},null,4)]),t("small",qt,[n(l(a.event.rsvp_count||0)+" of "+l(a.event.max_attendees)+" spots filled ",1),e[23]||(e[23]=t("br",null,null,-1)),t("strong",null,l(a.getRemainingSpots(a.event))+" spots remaining",1)])])):m("",!0),a.canRSVP?(d(),i("button",{key:1,onClick:e[0]||(e[0]=(...c)=>a.submitRSVP&&a.submitRSVP(...c)),class:"btn btn-primary btn-lg w-100 mb-3",disabled:a.rsvping},[a.rsvping?(d(),i(w,{key:0},[e[24]||(e[24]=t("span",{class:"spinner-border spinner-border-sm me-2"},null,-1)),e[25]||(e[25]=n(" Processing... ",-1))],64)):(d(),i(w,{key:1},[e[26]||(e[26]=t("i",{class:"fas fa-calendar-check me-2"},null,-1)),e[27]||(e[27]=n(" RSVP Now ",-1))],64))],8,Qt)):a.hasRSVPed?(d(),i("button",Gt,[...e[28]||(e[28]=[t("i",{class:"fas fa-check-circle me-2"},null,-1),n(" You're Attending ",-1)])])):(d(),i("button",Jt,[...e[29]||(e[29]=[t("i",{class:"fas fa-calendar-times me-2"},null,-1),n(" Event Full ",-1)])])),t("div",Kt,[t("button",{onClick:e[1]||(e[1]=(...c)=>a.shareEvent&&a.shareEvent(...c)),class:"btn btn-outline-primary"},[...e[30]||(e[30]=[t("i",{class:"fas fa-share-alt me-2"},null,-1),n("Share Event ",-1)])]),t("button",{onClick:e[2]||(e[2]=(...c)=>a.addToCalendar&&a.addToCalendar(...c)),class:"btn btn-outline-secondary"},[...e[31]||(e[31]=[t("i",{class:"fas fa-calendar-plus me-2"},null,-1),n("Add to Calendar ",-1)])])])])]),t("div",Xt,[t("div",$t,[e[36]||(e[36]=t("h5",{class:"card-title mb-3"},[t("i",{class:"fas fa-user-tie me-2 text-primary"}),n(" Event Organizer ")],-1)),t("div",te,[t("div",ee,[e[34]||(e[34]=t("div",{class:"organizer-avatar me-3"},[t("i",{class:"fas fa-user-circle fa-3x text-muted"})],-1)),t("div",null,[t("h6",se,l(a.event.created_by||"AVC Choir Team"),1),e[33]||(e[33]=t("p",{class:"text-muted mb-0 small"},"Event Coordinator",-1))])]),e[35]||(e[35]=G('<div class="organizer-contact" data-v-f621032a><p class="mb-2 small" data-v-f621032a><i class="fas fa-envelope me-2 text-muted" data-v-f621032a></i><a href="mailto:info@avcchoir.org" class="text-decoration-none" data-v-f621032a> info@avcchoir.org </a></p><p class="mb-0 small" data-v-f621032a><i class="fas fa-phone me-2 text-muted" data-v-f621032a></i><a href="tel:+256700123456" class="text-decoration-none" data-v-f621032a>+256 700 123 456</a></p></div>',1))])])]),t("div",ae,[t("div",ne,[e[47]||(e[47]=t("h5",{class:"card-title mb-3"},[t("i",{class:"fas fa-info-circle me-2 text-primary"}),n(" Quick Info ")],-1)),t("ul",oe,[t("li",re,[e[37]||(e[37]=t("i",{class:"fas fa-calendar-day me-2 text-muted"},null,-1)),e[38]||(e[38]=t("strong",null,"Date:",-1)),n(" "+l(a.formatShortDate(a.event.date)),1)]),t("li",le,[e[39]||(e[39]=t("i",{class:"fas fa-clock me-2 text-muted"},null,-1)),e[40]||(e[40]=t("strong",null,"Time:",-1)),n(" "+l(a.formatEventTime(a.event)),1)]),t("li",ie,[e[41]||(e[41]=t("i",{class:"fas fa-map-marker-alt me-2 text-muted"},null,-1)),e[42]||(e[42]=t("strong",null,"Venue:",-1)),n(" "+l(a.event.location),1)]),a.event.location_details?(d(),i("li",de,[e[43]||(e[43]=t("i",{class:"fas fa-building me-2 text-muted"},null,-1)),e[44]||(e[44]=t("strong",null,"Venue Details:",-1)),n(" "+l(a.event.location_details),1)])):m("",!0),t("li",null,[e[45]||(e[45]=t("i",{class:"fas fa-users me-2 text-muted"},null,-1)),e[46]||(e[46]=t("strong",null,"Type:",-1)),n(" "+l(a.formatEventType(a.event.type)),1)])])])])])])):m("",!0)])])}const ve=j($,[["render",ce],["__scopeId","data-v-f621032a"]]);export{ve as default};
