import{_ as I,a as d,o as i,b as t,s as a,v as m,d as v,F as y,r as c,t as n,q as f,y as h,l as F,m as _,E as u}from"./index-DSpDc2Ld.js";import{M as p}from"./bootstrap.esm-C02OvDcj.js";import{_ as g}from"./lodash-DfslGzQw.js";const w={name:"Rentals",data(){return{items:[],orders:[],itemSearch:"",orderSearch:"",editingItem:null,itemForm:{name:"",category:"",price_per_day:0,available_quantity:0},orderForm:{item:null,quantity:1,days:1,total_cost:0,payment_method:""}}},created(){this.debouncedLoadItems=g.debounce(this.loadItems,300),this.debouncedLoadOrders=g.debounce(this.loadOrders,300)},methods:{formatCurrency(o){return o==null?"$0.00":`$${parseFloat(o).toFixed(2)}`},formatDate(o){return o?new Date(o).toLocaleString():"-"},async loadItems(){const o=await u.get("/api/rentals/items/",{params:{search:this.itemSearch}});this.items=o.data.results||[]},openItemModal(o=null){this.editingItem=o,this.itemForm=o?{...o}:{name:"",category:"",price_per_day:0,available_quantity:0},new p(document.getElementById("itemModal")).show()},async saveItem(){this.editingItem?await u.put(`/api/rentals/items/${this.editingItem.id}/`,this.itemForm):await u.post("/api/rentals/items/",this.itemForm),await this.loadItems(),p.getInstance(document.getElementById("itemModal")).hide()},async deleteItem(o){confirm("Delete this item?")&&(await u.delete(`/api/rentals/items/${o}/`),await this.loadItems())},async loadOrders(){const o=await u.get("/api/rentals/orders/",{params:{search:this.orderSearch}});this.orders=o.data.results||[]},openOrderModal(){this.orderForm={item:null,quantity:1,days:1,total_cost:0,payment_method:""},new p(document.getElementById("orderModal")).show()},updateTotalCost(){const o=this.items.find(e=>e.id===this.orderForm.item);this.orderForm.total_cost=o?o.price_per_day*this.orderForm.quantity*this.orderForm.days:0},async saveOrder(){const o={items:[{item:this.orderForm.item,quantity:this.orderForm.quantity,days:this.orderForm.days}],payment_method:this.orderForm.payment_method,amount:this.orderForm.total_cost};await u.post("/api/rentals/orders/",o),alert("Order placed successfully!"),await this.loadOrders(),p.getInstance(document.getElementById("orderModal")).hide()},viewOrder(o){alert(JSON.stringify(o.items,null,2))},updateOrderStatus(o){const e=prompt("New status (pending, approved, returned, cancelled):",o.status);e&&u.patch(`/api/rentals/orders/${o.id}/`,{status:e.toLowerCase()}).then(this.loadOrders)},async deleteOrder(o){confirm("Delete this order?")&&(await u.delete(`/api/rentals/orders/${o}/`),await this.loadOrders())}},mounted(){this.loadItems(),this.loadOrders()}},C={class:"container py-5"},O={class:"tab-content",id:"rentalTabContent"},S={class:"tab-pane fade show active",id:"items"},k={class:"d-flex justify-content-between mb-3"},M={class:"table table-hover table-bordered"},q=["onClick"],T=["onClick"],V={key:0},D={class:"tab-pane fade",id:"orders"},x={class:"d-flex justify-content-between mb-3"},N={class:"table table-hover table-bordered"},U=["onClick"],L=["onClick"],A=["onClick"],E={key:0},B={class:"modal fade",id:"itemModal",tabindex:"-1"},P={class:"modal-dialog"},R={class:"modal-content"},j={class:"modal-header"},Q={class:"modal-title"},J={class:"modal-body"},z={class:"mb-3"},G={class:"mb-3"},H={class:"mb-3"},K={class:"mb-3"},W={type:"submit",class:"btn btn-primary"},X={class:"modal fade",id:"orderModal",tabindex:"-1"},Y={class:"modal-dialog modal-lg"},Z={class:"modal-content"},$={class:"modal-body"},tt={class:"row g-3"},et={class:"col-md-6"},st=["value"],ot={class:"col-md-3"},lt={class:"col-md-3"},rt={class:"mt-3"},nt={class:"mt-3"};function at(o,e,dt,it,l,r){return i(),d("div",C,[e[37]||(e[37]=t("h1",{class:"mb-4"},"Rental Management",-1)),e[38]||(e[38]=t("ul",{class:"nav nav-tabs mb-4",id:"rentalTab",role:"tablist"},[t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link active",id:"items-tab","data-bs-toggle":"tab","data-bs-target":"#items",type:"button"}," Items ")]),t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link",id:"orders-tab","data-bs-toggle":"tab","data-bs-target":"#orders",type:"button"}," Orders ")])],-1)),t("div",O,[t("div",S,[t("div",k,[a(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>l.itemSearch=s),onInput:e[1]||(e[1]=(...s)=>o.debouncedLoadItems&&o.debouncedLoadItems(...s)),type:"text",class:"form-control w-50",placeholder:"Search items..."},null,544),[[m,l.itemSearch]]),t("button",{class:"btn btn-success",onClick:e[2]||(e[2]=s=>r.openItemModal())},"Add Item")]),t("table",M,[e[20]||(e[20]=t("thead",{class:"table-dark"},[t("tr",null,[t("th",null,"Name"),t("th",null,"Category"),t("th",null,"Price/Day"),t("th",null,"Available"),t("th",null,"Actions")])],-1)),t("tbody",null,[(i(!0),d(y,null,c(l.items,s=>(i(),d("tr",{key:s.id},[t("td",null,n(s.name),1),t("td",null,n(s.category),1),t("td",null,n(r.formatCurrency(s.price_per_day)),1),t("td",null,n(s.available_quantity),1),t("td",null,[t("button",{class:"btn btn-sm btn-primary me-1",onClick:b=>r.openItemModal(s)},"Edit",8,q),t("button",{class:"btn btn-sm btn-danger",onClick:b=>r.deleteItem(s.id)},"Delete",8,T)])]))),128)),l.items.length===0?(i(),d("tr",V,[...e[19]||(e[19]=[t("td",{colspan:"5",class:"text-center"},"No items found.",-1)])])):v("",!0)])])]),t("div",D,[t("div",x,[a(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>l.orderSearch=s),onInput:e[4]||(e[4]=(...s)=>o.debouncedLoadOrders&&o.debouncedLoadOrders(...s)),type:"text",class:"form-control w-50",placeholder:"Search orders..."},null,544),[[m,l.orderSearch]]),t("button",{class:"btn btn-success",onClick:e[5]||(e[5]=s=>r.openOrderModal())},"New Order")]),t("table",N,[e[22]||(e[22]=t("thead",{class:"table-dark"},[t("tr",null,[t("th",null,"Order ID"),t("th",null,"Customer"),t("th",null,"Order Date"),t("th",null,"Status"),t("th",null,"Total Cost"),t("th",null,"Actions")])],-1)),t("tbody",null,[(i(!0),d(y,null,c(l.orders,s=>(i(),d("tr",{key:s.id},[t("td",null,n(s.id),1),t("td",null,n(s.customer_name),1),t("td",null,n(r.formatDate(s.order_date)),1),t("td",null,n(s.status),1),t("td",null,n(r.formatCurrency(s.total_cost)),1),t("td",null,[t("button",{class:"btn btn-sm btn-info me-1",onClick:b=>r.viewOrder(s)},"View",8,U),t("button",{class:"btn btn-sm btn-warning me-1",onClick:b=>r.updateOrderStatus(s)},"Update Status",8,L),t("button",{class:"btn btn-sm btn-danger",onClick:b=>r.deleteOrder(s.id)},"Delete",8,A)])]))),128)),l.orders.length===0?(i(),d("tr",E,[...e[21]||(e[21]=[t("td",{colspan:"6",class:"text-center"},"No orders found.",-1)])])):v("",!0)])])])]),t("div",B,[t("div",P,[t("div",R,[t("div",j,[t("h5",Q,n(l.editingItem?"Edit Item":"Add Item"),1),e[23]||(e[23]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"},null,-1))]),t("div",J,[t("form",{onSubmit:e[10]||(e[10]=f((...s)=>r.saveItem&&r.saveItem(...s),["prevent"]))},[t("div",z,[e[24]||(e[24]=t("label",{class:"form-label"},"Name",-1)),a(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>l.itemForm.name=s),type:"text",class:"form-control",required:""},null,512),[[m,l.itemForm.name]])]),t("div",G,[e[25]||(e[25]=t("label",{class:"form-label"},"Category",-1)),a(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>l.itemForm.category=s),type:"text",class:"form-control"},null,512),[[m,l.itemForm.category]])]),t("div",H,[e[26]||(e[26]=t("label",{class:"form-label"},"Price per Day",-1)),a(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>l.itemForm.price_per_day=s),type:"number",class:"form-control",min:"0",step:"0.01",required:""},null,512),[[m,l.itemForm.price_per_day,void 0,{number:!0}]])]),t("div",K,[e[27]||(e[27]=t("label",{class:"form-label"},"Available Quantity",-1)),a(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>l.itemForm.available_quantity=s),type:"number",class:"form-control",min:"0",required:""},null,512),[[m,l.itemForm.available_quantity,void 0,{number:!0}]])]),t("button",W,n(l.editingItem?"Update":"Add"),1)],32)])])])]),t("div",X,[t("div",Y,[t("div",Z,[e[36]||(e[36]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"New Order"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),t("div",$,[t("form",{onSubmit:e[18]||(e[18]=f((...s)=>r.saveOrder&&r.saveOrder(...s),["prevent"]))},[t("div",tt,[t("div",et,[e[29]||(e[29]=t("label",{class:"form-label"},"Select Item",-1)),a(t("select",{"onUpdate:modelValue":e[11]||(e[11]=s=>l.orderForm.item=s),onChange:e[12]||(e[12]=(...s)=>r.updateTotalCost&&r.updateTotalCost(...s)),class:"form-select",required:""},[e[28]||(e[28]=t("option",{value:"",disabled:""},"Select Item",-1)),(i(!0),d(y,null,c(l.items,s=>(i(),d("option",{key:s.id,value:s.id},n(s.name)+" - "+n(s.available_quantity)+" available",9,st))),128))],544),[[h,l.orderForm.item]])]),t("div",ot,[e[30]||(e[30]=t("label",{class:"form-label"},"Quantity",-1)),a(t("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>l.orderForm.quantity=s),onInput:e[14]||(e[14]=(...s)=>r.updateTotalCost&&r.updateTotalCost(...s)),type:"number",class:"form-control",min:"1",required:""},null,544),[[m,l.orderForm.quantity,void 0,{number:!0}]])]),t("div",lt,[e[31]||(e[31]=t("label",{class:"form-label"},"Days",-1)),a(t("input",{"onUpdate:modelValue":e[15]||(e[15]=s=>l.orderForm.days=s),onInput:e[16]||(e[16]=(...s)=>r.updateTotalCost&&r.updateTotalCost(...s)),type:"number",class:"form-control",min:"1",required:""},null,544),[[m,l.orderForm.days,void 0,{number:!0}]])])]),t("div",rt,[e[33]||(e[33]=t("label",{class:"form-label"},"Payment Method",-1)),a(t("select",{"onUpdate:modelValue":e[17]||(e[17]=s=>l.orderForm.payment_method=s),class:"form-select",required:""},[...e[32]||(e[32]=[F('<option value="" disabled data-v-2c50348e>Select Payment</option><option value="airtel" data-v-2c50348e>AirTel Money</option><option value="mtn" data-v-2c50348e>MTN Mobile Money</option><option value="paypal" data-v-2c50348e>PayPal</option><option value="stripe" data-v-2c50348e>Stripe</option>',5)])],512),[[h,l.orderForm.payment_method]])]),t("div",nt,[e[34]||(e[34]=t("strong",null,"Total Cost:",-1)),_(" "+n(r.formatCurrency(l.orderForm.total_cost)),1)]),e[35]||(e[35]=t("button",{type:"submit",class:"btn btn-primary mt-3"},"Place Order",-1))],32)])])])])])}const pt=I(w,[["render",at],["__scopeId","data-v-2c50348e"]]);export{pt as default};
