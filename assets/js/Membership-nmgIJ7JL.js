import{_ as y,a as i,o as n,b as s,d as m,q as _,s as u,v as c,y as f,n as b,m as p,t as a,F as j,r as q,E as h}from"./index-DSpDc2Ld.js";const g="http://localhost:8000/api/v1",R={name:"Membership",data(){return{joinForm:{full_name:"",email:"",phone:"",role:"chorister",experience:""},submitting:!1,successMessage:"",errorMessage:"",requests:[],loading:!1,filters:{status:"",role:""},isAdmin:!1}},methods:{async submitJoinRequest(){this.submitting=!0,this.successMessage="",this.errorMessage="";try{await h.post(`${g}/membership/join/`,this.joinForm),this.successMessage="Your request has been submitted successfully! We'll contact you soon.",this.joinForm={full_name:"",email:"",phone:"",role:"chorister",experience:""},setTimeout(()=>{this.successMessage=""},5e3)}catch(o){this.errorMessage=o.response?.data?.detail||"Failed to submit request. Please try again."}finally{this.submitting=!1}},async loadRequests(){if(this.isAdmin){this.loading=!0;try{const o={};this.filters.status&&(o.status=this.filters.status),this.filters.role&&(o.role=this.filters.role);const e=await h.get(`${g}/membership/join/requests/`,{params:o});this.requests=e.data}catch(o){console.error("Failed to load requests:",o),this.errorMessage="Failed to load membership requests."}finally{this.loading=!1}}},async updateStatus(o,e){try{await h.patch(`${g}/membership/join/requests/${o}/`,{status:e}),this.requests=this.requests.map(d=>d.id===o?{...d,status:e,processed_by:{username:"You"}}:d)}catch(d){console.error("Failed to update status:",d),this.errorMessage="Failed to update request status."}},formatDate(o){return o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"—"}},mounted(){this.isAdmin&&this.loadRequests()}},k={class:"membership-page"},F={class:"submission-section"},x={class:"form-grid"},M={class:"form-group"},S={class:"form-group"},C={class:"form-group"},w={class:"form-group"},A={class:"form-group full-width"},V=["disabled"],U={key:0},X={key:1,class:"loading-text"},B={key:0,class:"alert alert-success"},D={key:1,class:"alert alert-error"},E={key:0,class:"admin-section"},N={class:"filters-container"},P={class:"filter-group"},T={class:"filter-group"},I={class:"table-container"},J={key:0,class:"loading-state"},L={key:1,class:"empty-state"},Y={key:2,class:"table-responsive"},z={class:"requests-table"},O={class:"name-cell"},W={class:"contact-cell"},G={class:"contact-info"},H={class:"email"},K={class:"phone"},Q={class:"role-cell"},Z={class:"status-cell"},$={class:"date-cell"},ss={class:"processor-cell"},es={class:"actions-cell"},ts={class:"action-buttons"},ls=["onClick"],os=["onClick"],is={key:2,class:"no-actions"};function ns(o,e,d,rs,l,r){return n(),i("div",k,[s("section",F,[e[20]||(e[20]=s("div",{class:"section-header"},[s("h2",null,"Join the Choir"),s("p",{class:"section-subtitle"},"Become part of our worship ministry")],-1)),s("form",{onSubmit:e[5]||(e[5]=_((...t)=>r.submitJoinRequest&&r.submitJoinRequest(...t),["prevent"])),class:"join-form"},[s("div",x,[s("div",M,[e[11]||(e[11]=s("label",{class:"form-label"},"Full Name *",-1)),u(s("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>l.joinForm.full_name=t),type:"text",required:"",class:"form-input",placeholder:"Enter your full name"},null,512),[[c,l.joinForm.full_name]])]),s("div",S,[e[12]||(e[12]=s("label",{class:"form-label"},"Email *",-1)),u(s("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>l.joinForm.email=t),type:"email",required:"",class:"form-input",placeholder:"your.email@example.com"},null,512),[[c,l.joinForm.email]])]),s("div",C,[e[13]||(e[13]=s("label",{class:"form-label"},"Phone *",-1)),u(s("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>l.joinForm.phone=t),type:"text",required:"",class:"form-input",placeholder:"+256 XXX XXX XXX"},null,512),[[c,l.joinForm.phone]])]),s("div",w,[e[15]||(e[15]=s("label",{class:"form-label"},"Role *",-1)),u(s("select",{"onUpdate:modelValue":e[3]||(e[3]=t=>l.joinForm.role=t),required:"",class:"form-input"},[...e[14]||(e[14]=[s("option",{value:"chorister"},"Chorister",-1),s("option",{value:"instrumentalist"},"Instrumentalist",-1),s("option",{value:"supporter"},"Supporter",-1)])],512),[[f,l.joinForm.role]])]),s("div",A,[e[16]||(e[16]=s("label",{class:"form-label"},"Experience (Optional)",-1)),u(s("textarea",{"onUpdate:modelValue":e[4]||(e[4]=t=>l.joinForm.experience=t),rows:"4",class:"form-input form-textarea",placeholder:"Tell us about your musical background or why you want to join..."},null,512),[[c,l.joinForm.experience]])])]),s("button",{type:"submit",class:b(["submit-button",{"button-loading":l.submitting}]),disabled:l.submitting},[l.submitting?(n(),i("span",X,[...e[17]||(e[17]=[s("span",{class:"spinner"},null,-1),p(" Submitting... ",-1)])])):(n(),i("span",U,"Submit Request"))],10,V),l.successMessage?(n(),i("div",B,[e[18]||(e[18]=s("i",{class:"fas fa-check-circle"},null,-1)),p(" "+a(l.successMessage),1)])):m("",!0),l.errorMessage?(n(),i("div",D,[e[19]||(e[19]=s("i",{class:"fas fa-exclamation-circle"},null,-1)),p(" "+a(l.errorMessage),1)])):m("",!0)],32)]),l.isAdmin?(n(),i("section",E,[e[31]||(e[31]=s("div",{class:"section-header"},[s("h2",null,"Membership Requests"),s("p",{class:"section-subtitle"},"Manage choir membership applications")],-1)),s("div",N,[s("div",P,[e[22]||(e[22]=s("label",{class:"filter-label"},"Status:",-1)),u(s("select",{"onUpdate:modelValue":e[6]||(e[6]=t=>l.filters.status=t),onChange:e[7]||(e[7]=(...t)=>r.loadRequests&&r.loadRequests(...t)),class:"filter-select"},[...e[21]||(e[21]=[s("option",{value:""},"All Status",-1),s("option",{value:"pending"},"Pending",-1),s("option",{value:"approved"},"Approved",-1),s("option",{value:"rejected"},"Rejected",-1)])],544),[[f,l.filters.status]])]),s("div",T,[e[24]||(e[24]=s("label",{class:"filter-label"},"Role:",-1)),u(s("select",{"onUpdate:modelValue":e[8]||(e[8]=t=>l.filters.role=t),onChange:e[9]||(e[9]=(...t)=>r.loadRequests&&r.loadRequests(...t)),class:"filter-select"},[...e[23]||(e[23]=[s("option",{value:""},"All Roles",-1),s("option",{value:"chorister"},"Chorister",-1),s("option",{value:"instrumentalist"},"Instrumentalist",-1),s("option",{value:"supporter"},"Supporter",-1)])],544),[[f,l.filters.role]])]),s("button",{onClick:e[10]||(e[10]=(...t)=>r.loadRequests&&r.loadRequests(...t)),class:"refresh-button"},[...e[25]||(e[25]=[s("i",{class:"fas fa-sync-alt"},null,-1),p(" Refresh ",-1)])])]),s("div",I,[l.loading?(n(),i("div",J,[...e[26]||(e[26]=[s("div",{class:"spinner-large"},null,-1),s("p",null,"Loading requests...",-1)])])):l.requests.length===0?(n(),i("div",L,[...e[27]||(e[27]=[s("i",{class:"fas fa-inbox fa-3x"},null,-1),s("h3",null,"No requests found",-1),s("p",null,"There are no membership requests matching your criteria.",-1)])])):(n(),i("div",Y,[s("table",z,[e[30]||(e[30]=s("thead",null,[s("tr",null,[s("th",null,"Name"),s("th",null,"Contact"),s("th",null,"Role"),s("th",null,"Status"),s("th",null,"Submitted"),s("th",null,"Processed By"),s("th",null,"Actions")])],-1)),s("tbody",null,[(n(!0),i(j,null,q(l.requests,t=>(n(),i("tr",{key:t.id,class:"request-row"},[s("td",O,[s("strong",null,a(t.full_name),1)]),s("td",W,[s("div",G,[s("div",H,a(t.email),1),s("div",K,a(t.phone),1)])]),s("td",Q,[s("span",{class:b(["role-badge",t.role])},a(t.role),3)]),s("td",Z,[s("span",{class:b(["status-badge",t.status])},a(t.status),3)]),s("td",$,a(r.formatDate(t.submitted_at)),1),s("td",ss,a(t.processed_by?.username||"—"),1),s("td",es,[s("div",ts,[t.status==="pending"?(n(),i("button",{key:0,onClick:v=>r.updateStatus(t.id,"approved"),class:"btn-approve",title:"Approve Request"},[...e[28]||(e[28]=[s("i",{class:"fas fa-check"},null,-1),p(" Approve ",-1)])],8,ls)):m("",!0),t.status==="pending"?(n(),i("button",{key:1,onClick:v=>r.updateStatus(t.id,"rejected"),class:"btn-reject",title:"Reject Request"},[...e[29]||(e[29]=[s("i",{class:"fas fa-times"},null,-1),p(" Reject ",-1)])],8,os)):m("",!0),t.status!=="pending"?(n(),i("span",is," Processed ")):m("",!0)])])]))),128))])])]))])])):m("",!0)])}const us=y(R,[["render",ns],["__scopeId","data-v-d997cb31"]]);export{us as default};
