import{_,a as r,o as d,b as t,d as p,t as a,m,s as g,v as x,y as h,l as w,F as f,r as v,n as u,k as M,p as y}from"./index-DSpDc2Ld.js";const C={name:"ChoirMembersView",data(){return{members:[],stats:{},loading:!1,searchQuery:"",filterVoice:"",filterRole:"",filterStatus:"",showAddMemberModal:!1,pagination:{currentPage:1,pageSize:10,totalItems:0,totalPages:0,startIndex:0,endIndex:0,pages:[]}}},computed:{activeMembersCount(){return this.members.filter(s=>s.is_active).length},voicePartsCount(){const s={};return this.members.forEach(e=>{e.voice_type&&(s[e.voice_type]=(s[e.voice_type]||0)+1)}),s},filteredMembers(){let s=this.members;if(this.searchQuery){const l=this.searchQuery.toLowerCase();s=s.filter(i=>i.user&&i.user.toLowerCase().includes(l)||i.email&&i.email.toLowerCase().includes(l)||i.voice_type&&i.voice_type.toLowerCase().includes(l))}if(this.filterVoice&&(s=s.filter(l=>l.voice_type===this.filterVoice)),this.filterRole&&(s=s.filter(l=>l.role===this.filterRole)),this.filterStatus){const l=this.filterStatus==="active";s=s.filter(i=>i.is_active===l)}this.updatePagination(s.length);const e=(this.pagination.currentPage-1)*this.pagination.pageSize,c=e+this.pagination.pageSize;return s.slice(e,c)}},async mounted(){await this.loadData()},methods:{async loadData(){this.loading=!0;try{await Promise.all([this.loadMembers(),this.loadMemberStats()])}catch(s){console.error("Error loading choir data:",s),this.$notify({type:"error",title:"Loading Error",text:"Failed to load choir members data. Please try again."})}finally{this.loading=!1}},async loadMembers(){try{const s=await y.choir.getMembers();this.members=s.data.results||s.data||[],s.data.count!==void 0?this.pagination.totalItems=s.data.count:this.pagination.totalItems=this.members.length}catch(s){throw console.error("Error loading members:",s),this.members=[{id:1,user:"john.doe",email:"john@avc.com",voice_type:"Soprano",role:"Member",joined_on:"2024-01-15",is_active:!0,attendance_percentage:85},{id:2,user:"jane.smith",email:"jane@avc.com",voice_type:"Alto",role:"Leader",joined_on:"2023-11-20",is_active:!0,attendance_percentage:92},{id:3,user:"mike.johnson",email:"mike@avc.com",voice_type:"Tenor",role:"Member",joined_on:"2024-02-10",is_active:!1,attendance_percentage:45}],this.pagination.totalItems=this.members.length,s}},async loadMemberStats(){try{const s=await y.choir.getMemberStats();this.stats=s.data}catch(s){console.error("Error loading member stats:",s),this.stats={total_members:this.members.length,voice_distribution:this.voicePartsCount}}},updatePagination(s){this.pagination.totalItems=s,this.pagination.totalPages=Math.ceil(s/this.pagination.pageSize),this.pagination.startIndex=Math.min((this.pagination.currentPage-1)*this.pagination.pageSize+1,s),this.pagination.endIndex=Math.min(this.pagination.currentPage*this.pagination.pageSize,s);const e=[],c=5;let l=Math.max(1,this.pagination.currentPage-Math.floor(c/2)),i=Math.min(this.pagination.totalPages,l+c-1);i-l+1<c&&(l=Math.max(1,i-c+1));for(let n=l;n<=i;n++)e.push(n);this.pagination.pages=e},changePage(s){s>=1&&s<=this.pagination.totalPages&&(this.pagination.currentPage=s)},getUserInitial(s){return s?s.charAt(0).toUpperCase():"U"},formatDate(s){return s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"Unknown"},getRoleBadgeClass(s){return{Leader:"bg-warning text-dark",Conductor:"bg-danger",Member:"bg-secondary"}[s]||"bg-secondary"},getAttendanceRateClass(s){return s>=80?"bg-success":s>=60?"bg-warning":"bg-danger"},viewMemberProfile(s){this.$notify({type:"info",title:"View Profile",text:`Viewing profile for ${s.user}`}),this.$router.push(`/choir/members/${s.id}`)},editMember(s){this.$notify({type:"info",title:"Edit Member",text:`Editing ${s.user}`})},viewAttendance(s){this.$notify({type:"info",title:"View Attendance",text:`Viewing attendance for ${s.user}`}),this.$router.push(`/attendance?member=${s.id}`)},async refreshData(){await this.loadData(),this.$notify({type:"success",title:"Data Refreshed",text:"Choir members data has been updated"})}}},k={class:"choir-members-page"},P={class:"container-fluid pt-5"},A={key:0,class:"text-center py-5"},S={key:1},V={class:"row mb-4"},D={class:"col-md-3 mb-3"},I={class:"card border-0 shadow-sm"},R={class:"card-body text-center"},j={class:"col-md-3 mb-3"},L={class:"card border-0 shadow-sm"},U={class:"card-body text-center"},z={class:"col-md-3 mb-3"},E={class:"card border-0 shadow-sm"},N={class:"card-body text-center"},T={class:"col-md-3 mb-3"},B={class:"card border-0 shadow-sm"},Q={class:"card-body text-center"},F={class:"card border-0 shadow-sm mb-4"},q={class:"card-body"},J={class:"d-flex justify-content-between align-items-center"},G={class:"card-title mb-0"},H={class:"badge bg-primary ms-2"},K={class:"d-flex gap-2"},O={class:"card border-0 shadow-sm mb-4"},W={class:"card-body"},X={class:"row g-3"},Y={class:"col-md-4"},Z={class:"col-md-3"},$={class:"col-md-3"},tt={class:"col-md-2"},et={class:"card border-0 shadow-sm"},st={class:"card-body p-0"},it={class:"table-responsive"},ot={class:"table table-hover mb-0"},nt={class:"d-flex align-items-center"},at={class:"avatar-placeholder bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-3",style:{width:"40px",height:"40px"}},lt={class:"d-block"},rt={class:"text-muted"},dt={class:"badge bg-info"},ct={class:"text-nowrap"},ut={class:"d-flex align-items-center"},mt={class:"progress flex-grow-1 me-2",style:{height:"6px"}},gt={class:"btn-group btn-group-sm"},bt=["onClick"],pt=["onClick"],ht=["onClick"],ft={key:0,class:"text-center py-5"},vt={key:1,class:"d-flex justify-content-between align-items-center p-3 border-top"},yt={class:"text-muted"},_t={class:"pagination mb-0"},xt=["onClick"],wt={key:0,class:"modal fade show d-block",style:{"background-color":"rgba(0,0,0,0.5)"}},Mt={class:"modal-dialog"},Ct={class:"modal-content"},kt={class:"modal-header"},Pt={class:"modal-footer"};function At(s,e,c,l,i,n){return d(),r("div",k,[t("div",P,[i.loading?(d(),r("div",A,[...e[11]||(e[11]=[t("div",{class:"spinner-border text-primary",role:"status"},null,-1),t("p",{class:"text-muted mt-3"},"Loading choir members...",-1)])])):(d(),r("div",S,[t("div",V,[t("div",D,[t("div",I,[t("div",R,[e[12]||(e[12]=t("i",{class:"fas fa-users fa-2x text-primary mb-2"},null,-1)),t("h3",null,a(i.stats.total_members||0),1),e[13]||(e[13]=t("p",{class:"text-muted mb-0"},"Total Members",-1))])])]),t("div",j,[t("div",L,[t("div",U,[e[14]||(e[14]=t("i",{class:"fas fa-user-check fa-2x text-success mb-2"},null,-1)),t("h3",null,a(n.activeMembersCount),1),e[15]||(e[15]=t("p",{class:"text-muted mb-0"},"Active Members",-1))])])]),t("div",z,[t("div",E,[t("div",N,[e[16]||(e[16]=t("i",{class:"fas fa-music fa-2x text-info mb-2"},null,-1)),t("h3",null,a(n.voicePartsCount.Soprano||0),1),e[17]||(e[17]=t("p",{class:"text-muted mb-0"},"Soprano",-1))])])]),t("div",T,[t("div",B,[t("div",Q,[e[18]||(e[18]=t("i",{class:"fas fa-microphone fa-2x text-warning mb-2"},null,-1)),t("h3",null,a(n.voicePartsCount.Alto||0),1),e[19]||(e[19]=t("p",{class:"text-muted mb-0"},"Alto",-1))])])])]),t("div",F,[t("div",q,[t("div",J,[t("h5",G,[e[20]||(e[20]=t("i",{class:"fas fa-users me-2"},null,-1)),e[21]||(e[21]=m("Member Directory ",-1)),t("span",H,a(n.filteredMembers.length),1)]),t("div",K,[t("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=o=>i.showAddMemberModal=!0)},[...e[22]||(e[22]=[t("i",{class:"fas fa-plus me-1"},null,-1),m("Add Member ",-1)])]),t("button",{class:"btn btn-outline-secondary",onClick:e[1]||(e[1]=(...o)=>n.refreshData&&n.refreshData(...o))},[...e[23]||(e[23]=[t("i",{class:"fas fa-refresh me-1"},null,-1),m("Refresh ",-1)])])])])])]),t("div",O,[t("div",W,[t("div",X,[t("div",Y,[g(t("input",{type:"text",class:"form-control",placeholder:"Search by name or email...","onUpdate:modelValue":e[2]||(e[2]=o=>i.searchQuery=o)},null,512),[[x,i.searchQuery]])]),t("div",Z,[g(t("select",{class:"form-select","onUpdate:modelValue":e[3]||(e[3]=o=>i.filterVoice=o)},[...e[24]||(e[24]=[w('<option value="" data-v-195518d5>All Voice Parts</option><option value="Soprano" data-v-195518d5>Soprano</option><option value="Alto" data-v-195518d5>Alto</option><option value="Tenor" data-v-195518d5>Tenor</option><option value="Bass" data-v-195518d5>Bass</option>',5)])],512),[[h,i.filterVoice]])]),t("div",$,[g(t("select",{class:"form-select","onUpdate:modelValue":e[4]||(e[4]=o=>i.filterRole=o)},[...e[25]||(e[25]=[t("option",{value:""},"All Roles",-1),t("option",{value:"Member"},"Member",-1),t("option",{value:"Leader"},"Leader",-1),t("option",{value:"Conductor"},"Conductor",-1)])],512),[[h,i.filterRole]])]),t("div",tt,[g(t("select",{class:"form-select","onUpdate:modelValue":e[5]||(e[5]=o=>i.filterStatus=o)},[...e[26]||(e[26]=[t("option",{value:""},"All Status",-1),t("option",{value:"active"},"Active",-1),t("option",{value:"inactive"},"Inactive",-1)])],512),[[h,i.filterStatus]])])])])]),t("div",et,[t("div",st,[t("div",it,[t("table",ot,[e[31]||(e[31]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"Member"),t("th",null,"Voice Part"),t("th",null,"Role"),t("th",null,"Join Date"),t("th",null,"Attendance Rate"),t("th",null,"Status"),t("th",null,"Actions")])],-1)),t("tbody",null,[(d(!0),r(f,null,v(n.filteredMembers,o=>(d(),r("tr",{key:o.id},[t("td",null,[t("div",nt,[t("div",at,a(n.getUserInitial(o.user)),1),t("div",null,[t("strong",lt,a(o.user||"Unknown"),1),t("small",rt,a(o.email||"No email"),1)])])]),t("td",null,[t("span",dt,a(o.voice_type||"Not set"),1)]),t("td",null,[t("span",{class:u(["badge",n.getRoleBadgeClass(o.role)])},a(o.role||"Member"),3)]),t("td",null,[t("span",ct,a(n.formatDate(o.joined_on)),1)]),t("td",null,[t("div",ut,[t("div",mt,[t("div",{class:u(["progress-bar",n.getAttendanceRateClass(o.attendance_percentage)]),style:M({width:o.attendance_percentage+"%"})},null,6)]),t("small",null,a(o.attendance_percentage||0)+"%",1)])]),t("td",null,[t("span",{class:u(["badge",o.is_active?"bg-success":"bg-danger"])},[e[27]||(e[27]=t("i",{class:"fas fa-circle me-1",style:{"font-size":"0.5rem"}},null,-1)),m(" "+a(o.is_active?"Active":"Inactive"),1)],2)]),t("td",null,[t("div",gt,[t("button",{class:"btn btn-outline-primary",onClick:b=>n.viewMemberProfile(o),title:"View Profile"},[...e[28]||(e[28]=[t("i",{class:"fas fa-eye"},null,-1)])],8,bt),t("button",{class:"btn btn-outline-secondary",onClick:b=>n.editMember(o),title:"Edit Member"},[...e[29]||(e[29]=[t("i",{class:"fas fa-edit"},null,-1)])],8,pt),t("button",{class:"btn btn-outline-info",onClick:b=>n.viewAttendance(o),title:"View Attendance"},[...e[30]||(e[30]=[t("i",{class:"fas fa-clipboard-check"},null,-1)])],8,ht)])])]))),128))])])]),n.filteredMembers.length===0&&!i.loading?(d(),r("div",ft,[e[33]||(e[33]=t("i",{class:"fas fa-users fa-3x text-muted mb-3"},null,-1)),e[34]||(e[34]=t("h5",null,"No members found",-1)),e[35]||(e[35]=t("p",{class:"text-muted"},"Try adjusting your search criteria or add new members",-1)),t("button",{class:"btn btn-primary",onClick:e[6]||(e[6]=o=>i.showAddMemberModal=!0)},[...e[32]||(e[32]=[t("i",{class:"fas fa-plus me-1"},null,-1),m("Add First Member ",-1)])])])):p("",!0),i.pagination.totalPages>1?(d(),r("div",vt,[t("div",yt," Showing "+a(i.pagination.startIndex)+"-"+a(i.pagination.endIndex)+" of "+a(i.pagination.totalItems)+" members ",1),t("nav",null,[t("ul",_t,[t("li",{class:u(["page-item",{disabled:i.pagination.currentPage===1}])},[t("button",{class:"page-link",onClick:e[7]||(e[7]=o=>n.changePage(i.pagination.currentPage-1))}," Previous ")],2),(d(!0),r(f,null,v(i.pagination.pages,o=>(d(),r("li",{key:o,class:u(["page-item",{active:o===i.pagination.currentPage}])},[t("button",{class:"page-link",onClick:b=>n.changePage(o)},a(o),9,xt)],2))),128)),t("li",{class:u(["page-item",{disabled:i.pagination.currentPage===i.pagination.totalPages}])},[t("button",{class:"page-link",onClick:e[8]||(e[8]=o=>n.changePage(i.pagination.currentPage+1))}," Next ")],2)])])])):p("",!0)])])]))]),i.showAddMemberModal?(d(),r("div",wt,[t("div",Mt,[t("div",Ct,[t("div",kt,[e[36]||(e[36]=t("h5",{class:"modal-title"},"Add New Member",-1)),t("button",{type:"button",class:"btn-close",onClick:e[9]||(e[9]=o=>i.showAddMemberModal=!1)})]),e[38]||(e[38]=t("div",{class:"modal-body"},[t("p",null,"Member addition functionality will be implemented here."),t("p",{class:"text-muted"},"This would connect to your backend to create new choir members.")],-1)),t("div",Pt,[t("button",{type:"button",class:"btn btn-secondary",onClick:e[10]||(e[10]=o=>i.showAddMemberModal=!1)},"Close"),e[37]||(e[37]=t("button",{type:"button",class:"btn btn-primary",disabled:""},"Add Member",-1))])])])])):p("",!0)])}const Vt=_(C,[["render",At],["__scopeId","data-v-195518d5"]]);export{Vt as default};
