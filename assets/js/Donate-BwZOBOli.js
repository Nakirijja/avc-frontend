import{_ as I,a as r,o as i,b as e,d as c,k as _,t as a,F as p,r as b,n as u,s as g,v as y,m as f,p as v}from"./index-DSpDc2Ld.js";const D="/avc-frontend/assets/img/hero-1-Ds52Kl63.jpg",x="/avc-frontend/assets/img/hero-2-5rRQ05zo.jpg",k="/avc-frontend/assets/img/hero-3-xYl2fIQw.jpg",w="/avc-frontend/assets/img/hero-4-DHom_PMv.jpg",S="/avc-frontend/assets/img/hero-5-Dcj-4-G_.jpg",C={name:"DonateView",data(){return{selectedTier:null,customAmount:null,selectedMethod:"mobile_money",processing:!1,showSuccessModal:!1,donorInfo:{name:"",email:"",message:""},paymentDetails:{phone:""},errors:{},summary:{total_amount:0,total_donations:0,unique_donors:0},lastDonation:{},currentImageIndex:0,heroImages:[{url:D,alt:"AVC Choir performing at concert"},{url:x,alt:"AVC members in rehearsal"},{url:k,alt:"AVC community outreach event"},{url:w,alt:"AVC choir in traditional attire"},{url:S,alt:"AVC musical performance"}],imageInterval:null,overlayOptions:["rgba(0, 0, 0, 0.3)","rgba(0, 0, 0, 0.4)","rgba(0, 0, 0, 0.5)"],currentOverlay:0,donationTiers:[{id:1,amount:5e4,name:"Basic Support"},{id:2,amount:1e5,name:"Friend of Choir"},{id:3,amount:25e4,name:"Silver Sponsor"},{id:4,amount:5e5,name:"Gold Sponsor"},{id:5,amount:1e6,name:"Platinum Sponsor"}],paymentMethods:[{id:"mobile_money",name:"Mobile Money",icon:"fas fa-mobile-alt"},{id:"bank_transfer",name:"Bank Transfer",icon:"fas fa-university"},{id:"credit_card",name:"Credit Card",icon:"fas fa-credit-card"},{id:"cash",name:"Cash",icon:"fas fa-money-bill"}],impacts:[{id:1,icon:"fas fa-music",title:"Music Equipment",description:"Help purchase instruments and sound equipment"},{id:2,icon:"fas fa-tshirt",title:"Choir Uniforms",description:"Support our members with performance attire"},{id:3,icon:"fas fa-bus",title:"Transportation",description:"Enable us to reach community events"},{id:4,icon:"fas fa-graduation-cap",title:"Music Education",description:"Fund workshops and training sessions"}],recentDonations:[]}},computed:{heroStyle(){return{backgroundImage:`url(${this.heroImages[this.currentImageIndex].url})`,backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:"fixed",transition:"background-image 1s ease-in-out"}},overlayStyle(){return{backgroundColor:this.overlayOptions[this.currentOverlay]}}},async mounted(){await Promise.all([this.loadDonationSummary(),this.loadRecentDonations()]),this.preloadImages(),this.startImageRotation()},beforeUnmount(){this.stopImageRotation()},methods:{preloadImages(){this.heroImages.forEach(n=>{const t=new Image;t.src=n.url})},startImageRotation(){this.imageInterval=setInterval(()=>{this.nextImage()},5e3)},stopImageRotation(){this.imageInterval&&(clearInterval(this.imageInterval),this.imageInterval=null)},nextImage(){this.currentImageIndex=(this.currentImageIndex+1)%this.heroImages.length},setImage(n){this.currentImageIndex=n,this.stopImageRotation(),this.startImageRotation()},adjustOverlay(n=!0){n&&this.currentOverlay<this.overlayOptions.length-1?this.currentOverlay++:!n&&this.currentOverlay>0&&this.currentOverlay--},selectTier(n){this.selectedTier=n.id,this.customAmount=null,this.clearErrors()},selectCustomAmount(){this.selectedTier=null,this.clearErrors()},selectMethod(n){this.selectedMethod=n,this.clearErrors()},getDonationAmount(){if(this.customAmount)return parseInt(this.customAmount);if(this.selectedTier){const n=this.donationTiers.find(t=>t.id===this.selectedTier);return n?n.amount:0}return 0},async processDonation(){this.clearErrors();const n=this.getDonationAmount();if(n<=0){this.errors.amount=["Please select or enter a donation amount"];return}if(!this.donorInfo.name){this.errors.donor_name=["Full name is required"];return}if(!this.selectedMethod){this.errors.method=["Please select a payment method"];return}if(this.selectedMethod=="mobile_money"&&!this.paymentDetails.phone){alert("Please enter your phone number for mobile money payment");return}this.processing=!0;try{const t={amount:n,donor_name:this.donorInfo.name,donor_email:this.donorInfo.email,method:this.selectedMethod,notes:this.donorInfo.message};this.selectedMethod==="mobile_money"&&(t.phone_number=this.paymentDetails.phone);const d=await v.donations.createDonation(t);this.lastDonation=d.data,this.showSuccessModal=!0,await Promise.all([this.loadDonationSummary(),this.loadRecentDonations()]),this.resetForm()}catch(t){console.error("Donation error:",t),t.response?.data?this.errors=t.response.data:alert("There was an error processing your donation. Please try again.")}finally{this.processing=!1}},async loadDonationSummary(){try{const n=await v.donations.getSummary();this.summary=n.data}catch(n){console.error("Error loading donation summary:",n),this.summary={total_amount:0,total_donations:0,unique_donors:0}}},async loadRecentDonations(){for(let d=1;d<=3;d++)try{const m=await v.donations.getDonations();this.recentDonations=m.data.results?m.data.results.slice(0,5):m.data.slice(0,5);return}catch(m){if(console.error(`Error loading recent donations (attempt ${d}/3):`,m),m.response?.status===429&&d<3){await new Promise(s=>setTimeout(s,1e3*d));continue}this.recentDonations=[];break}},resetForm(){this.selectedTier=null,this.customAmount=null,this.donorInfo={name:"",email:"",message:""},this.paymentDetails.phone="",this.errors={}},clearErrors(){this.errors={}},formatDate(n){return new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}}},M={class:"donate-page"},A={class:"container py-5 position-relative"},T={class:"row align-items-center"},R={class:"col-lg-8"},E={class:"row mt-4"},U={class:"col-md-4"},V={class:"text-center stat-item"},P={class:"fw-bold stat-number"},O={class:"col-md-4"},j={class:"text-center stat-item"},q={class:"fw-bold stat-number"},F={class:"col-md-4"},G={class:"text-center stat-item"},H={class:"fw-bold stat-number"},L={class:"hero-indicators"},B=["onClick","aria-label"],X={class:"container py-5"},N={class:"row"},Y={class:"col-lg-8"},z={class:"card border-0 shadow-sm mb-4"},Q={class:"card-body"},K={class:"row mb-4"},W={class:"col-12"},J={class:"d-flex flex-wrap gap-2"},Z=["onClick"],$={class:"input-group",style:{width:"200px"}},ee={key:0,class:"text-danger"},te={class:"row"},se={class:"col-md-6 mb-3"},oe={key:0,class:"invalid-feedback"},ne={class:"col-md-6 mb-3"},re={key:0,class:"invalid-feedback"},ie={class:"col-12 mb-3"},ae={class:"mb-4"},le={class:"row"},de=["onClick"],me={class:"small mb-0"},ce={key:0,class:"text-danger"},ue={key:0,class:"mb-4"},he=["disabled"],pe={key:0,class:"spinner-border spinner-border-sm me-2"},be={class:"col-lg-4"},ge={class:"card border-0 shadow-sm mb-4"},ye={class:"card-body"},fe={class:"mb-0"},ve={class:"text-muted"},_e={class:"card border-0 shadow-sm"},Ie={class:"card-body"},De={key:0,class:"text-center text-muted py-3"},xe={key:1},ke={class:"text-muted"},we={class:"badge bg-success"},Se={class:"text-center mt-3"},Ce={key:0,class:"modal fade show d-block",style:{"background-color":"rgba(0,0,0,0.5)"}},Me={class:"modal-dialog modal-dialog-centered"},Ae={class:"modal-content"},Te={class:"modal-body text-center"},Re={class:"lead"},Ee={class:"modal-footer border-0 justify-content-center"};function Ue(n,t,d,m,s,l){return i(),r("div",M,[e("section",{class:"donate-hero text-white py-5",style:_(l.heroStyle)},[e("div",{class:"hero-overlay",style:_(l.overlayStyle)},null,4),e("div",A,[e("div",T,[e("div",R,[t[12]||(t[12]=e("h1",{class:"display-4 fw-bold mb-4 hero-title"},"Support Our Mission",-1)),t[13]||(t[13]=e("p",{class:"lead hero-subtitle"},"Your donation helps us continue creating beautiful music and serving our community",-1)),e("div",E,[e("div",U,[e("div",V,[e("h4",P,"UGX "+a(s.summary.total_amount?s.summary.total_amount.toLocaleString():"0"),1),t[9]||(t[9]=e("p",{class:"mb-0 stat-label"},"Total Raised",-1))])]),e("div",O,[e("div",j,[e("h4",q,a(s.summary.total_donations||0),1),t[10]||(t[10]=e("p",{class:"mb-0 stat-label"},"Total Donations",-1))])]),e("div",F,[e("div",G,[e("h4",H,a(s.summary.unique_donors||0),1),t[11]||(t[11]=e("p",{class:"mb-0 stat-label"},"Supporters",-1))])])])]),t[14]||(t[14]=e("div",{class:"col-lg-4 text-center"},[e("i",{class:"fas fa-heart fa-6x hero-icon"})],-1))]),e("div",L,[(i(!0),r(p,null,b(s.heroImages,(o,h)=>(i(),r("button",{key:h,class:u(["indicator-dot",{active:s.currentImageIndex===h}]),onClick:Ve=>l.setImage(h),"aria-label":`Show background image ${h+1}`},null,10,B))),128))])])],4),e("div",X,[e("div",N,[e("div",Y,[e("div",z,[t[23]||(t[23]=e("div",{class:"card-header bg-white"},[e("h3",{class:"card-title mb-0"},"Make a Donation")],-1)),e("div",Q,[e("div",K,[e("div",W,[t[16]||(t[16]=e("h5",{class:"mb-3"},"Select Donation Amount",-1)),e("div",J,[(i(!0),r(p,null,b(s.donationTiers,o=>(i(),r("button",{key:o.id,class:u(["btn",s.selectedTier===o.id?"btn-primary":"btn-outline-primary"]),onClick:h=>l.selectTier(o)}," UGX "+a(o.amount.toLocaleString()),11,Z))),128)),e("div",$,[t[15]||(t[15]=e("span",{class:"input-group-text"},"UGX",-1)),g(e("input",{type:"number",class:"form-control",placeholder:"Custom amount","onUpdate:modelValue":t[0]||(t[0]=o=>s.customAmount=o),onFocus:t[1]||(t[1]=(...o)=>l.selectCustomAmount&&l.selectCustomAmount(...o)),min:"1"},null,544),[[y,s.customAmount]])])]),s.errors.amount?(i(),r("small",ee,a(s.errors.amount[0]),1)):c("",!0)])]),e("div",te,[e("div",se,[t[17]||(t[17]=e("label",{class:"form-label"},"Full Name *",-1)),g(e("input",{type:"text",class:u(["form-control",{"is-invalid":s.errors.donor_name}]),"onUpdate:modelValue":t[2]||(t[2]=o=>s.donorInfo.name=o),required:""},null,2),[[y,s.donorInfo.name]]),s.errors.donor_name?(i(),r("div",oe,a(s.errors.donor_name[0]),1)):c("",!0)]),e("div",ne,[t[18]||(t[18]=e("label",{class:"form-label"},"Email Address *",-1)),g(e("input",{type:"email",class:u(["form-control",{"is-invalid":s.errors.donor_email}]),"onUpdate:modelValue":t[3]||(t[3]=o=>s.donorInfo.email=o),required:""},null,2),[[y,s.donorInfo.email]]),s.errors.donor_email?(i(),r("div",re,a(s.errors.donor_email[0]),1)):c("",!0)]),e("div",ie,[t[19]||(t[19]=e("label",{class:"form-label"},"Message (Optional)",-1)),g(e("textarea",{class:"form-control",rows:"3","onUpdate:modelValue":t[4]||(t[4]=o=>s.donorInfo.message=o),placeholder:"Add a message of support..."},null,512),[[y,s.donorInfo.message]])])]),e("div",ae,[t[20]||(t[20]=e("h5",{class:"mb-3"},"Payment Method *",-1)),e("div",le,[(i(!0),r(p,null,b(s.paymentMethods,o=>(i(),r("div",{class:"col-md-3 mb-2",key:o.id},[e("div",{class:u(["payment-method-card text-center p-3 border rounded",{"border-primary":s.selectedMethod===o.id}]),onClick:h=>l.selectMethod(o.id)},[e("i",{class:u([o.icon,"fa-2x mb-2"])},null,2),e("p",me,a(o.name),1)],10,de)]))),128))]),s.errors.method?(i(),r("small",ce,a(s.errors.method[0]),1)):c("",!0)]),s.selectedMethod==="mobile_money"?(i(),r("div",ue,[t[21]||(t[21]=e("label",{class:"form-label"},"Phone Number *",-1)),g(e("input",{type:"tel",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=o=>s.paymentDetails.phone=o),placeholder:"e.g., 0751234567",required:""},null,512),[[y,s.paymentDetails.phone]]),t[22]||(t[22]=e("small",{class:"text-muted"},"Enter your mobile money registered phone number",-1))])):c("",!0),e("button",{class:"btn btn-primary btn-lg w-100 py-3",onClick:t[6]||(t[6]=(...o)=>l.processDonation&&l.processDonation(...o)),disabled:s.processing},[s.processing?(i(),r("span",pe)):c("",!0),f(" "+a(s.processing?"Processing...":`Donate UGX ${l.getDonationAmount().toLocaleString()}`),1)],8,he)])])]),e("div",be,[e("div",ge,[t[24]||(t[24]=e("div",{class:"card-header bg-white"},[e("h5",{class:"card-title mb-0"},"Your Impact")],-1)),e("div",ye,[(i(!0),r(p,null,b(s.impacts,o=>(i(),r("div",{class:"impact-item d-flex align-items-center mb-3",key:o.id},[e("i",{class:u([o.icon,"text-primary fa-lg me-3"])},null,2),e("div",null,[e("h6",fe,a(o.title),1),e("small",ve,a(o.description),1)])]))),128))])]),e("div",_e,[t[28]||(t[28]=e("div",{class:"card-header bg-white"},[e("h5",{class:"card-title mb-0"},"Recent Supporters")],-1)),e("div",Ie,[s.recentDonations.length===0?(i(),r("div",De,[...t[25]||(t[25]=[e("p",null,"Be the first to support us!",-1)])])):(i(),r("div",xe,[(i(!0),r(p,null,b(s.recentDonations,o=>(i(),r("div",{key:o.id,class:"d-flex justify-content-between align-items-center mb-2"},[e("div",null,[e("strong",null,a(o.display_name),1),t[26]||(t[26]=e("br",null,null,-1)),e("small",ke,a(l.formatDate(o.date)),1)]),e("span",we,"UGX "+a(o.amount.toLocaleString()),1)]))),128))])),e("div",Se,[e("button",{class:"btn btn-sm btn-outline-primary",onClick:t[7]||(t[7]=(...o)=>l.loadRecentDonations&&l.loadRecentDonations(...o))},[...t[27]||(t[27]=[e("i",{class:"fas fa-refresh me-1"},null,-1),f("Refresh ",-1)])])])])])])])]),s.showSuccessModal?(i(),r("div",Ce,[e("div",Me,[e("div",Ae,[t[33]||(t[33]=e("div",{class:"modal-header border-0"},[e("h5",{class:"modal-title text-success"},[e("i",{class:"fas fa-check-circle me-2"}),f("Donation Successful! ")])],-1)),e("div",Te,[t[31]||(t[31]=e("i",{class:"fas fa-heart fa-3x text-success mb-3"},null,-1)),e("h4",null,"Thank You, "+a(s.lastDonation.donor_name)+"!",1),e("p",Re,[t[29]||(t[29]=f("Your donation of ",-1)),e("strong",null,"UGX "+a(s.lastDonation.amount?s.lastDonation.amount.toLocaleString():"0"),1),t[30]||(t[30]=f(" has been received.",-1))]),t[32]||(t[32]=e("p",{class:"text-muted"},"We appreciate your support in our mission to create beautiful music.",-1))]),e("div",Ee,[e("button",{type:"button",class:"btn btn-primary",onClick:t[8]||(t[8]=o=>s.showSuccessModal=!1)},"Continue")])])])])):c("",!0)])}const Oe=I(C,[["render",Ue],["__scopeId","data-v-b08ac1e8"]]);export{Oe as default};
