import{_ as y,a as l,o as i,b as t,s as d,v as c,d as b,F as v,r as f,t as r,n as h,q as T,y as g,l as M,E as u}from"./index-DSpDc2Ld.js";import{M as m}from"./bootstrap.esm-C02OvDcj.js";const _={name:"Transactions",data(){return{transactions:[],search:"",transactionForm:{payment_method:"",amount:0,currency:"UGX",phone_number:""},selectedTransaction:null}},computed:{requiresPhone(){return["AIRTEL","MTN"].includes(this.transactionForm.payment_method)}},methods:{async loadTransactions(){try{const s=await u.get("/api/v1/transactions/",{params:{search:this.search}});this.transactions=s.data.results||[]}catch(s){console.error("Error loading transactions:",s)}},openTransactionModal(){this.transactionForm={payment_method:"",amount:0,currency:"UGX",phone_number:""},new m(document.getElementById("transactionModal")).show()},async saveTransaction(){try{await u.post("/api/v1/transactions/",this.transactionForm),alert("Transaction initiated!"),this.loadTransactions(),m.getInstance(document.getElementById("transactionModal")).hide()}catch(s){alert("Error: "+(s.response?.data?.detail||s.message))}},viewTransaction(s){this.selectedTransaction=s,new m(document.getElementById("transactionDetailsModal")).show()},async deleteTransaction(s){confirm("Delete this transaction?")&&(await u.delete(`/api/v1/transactions/${s}/`),this.loadTransactions())},statusClass(s){switch(s){case"SUCCESS":return"badge bg-success";case"FAILED":return"badge bg-danger";case"PENDING":return"badge bg-warning text-dark";default:return"badge bg-secondary"}},formatCurrency(s){return s==null?"$0.00":`$${parseFloat(s).toFixed(2)}`},formatDate(s){return s?new Date(s).toLocaleString():"-"}},mounted(){this.loadTransactions()}},w={class:"container py-5"},F={class:"d-flex justify-content-between mb-3"},C={class:"table table-hover table-bordered"},P=["onClick"],D=["onClick"],E={key:0},S={class:"modal fade",id:"transactionModal",tabindex:"-1"},k={class:"modal-dialog"},I={class:"modal-content"},N={class:"modal-body"},X={class:"mb-3"},A={class:"mb-3"},U={key:0,class:"mb-3"},V={class:"mb-3"},q={class:"modal fade",id:"transactionDetailsModal",tabindex:"-1"},B={class:"modal-dialog modal-lg"},L={class:"modal-content"},G={class:"modal-body"};function R(s,e,x,j,a,o){return i(),l("div",w,[e[18]||(e[18]=t("h1",{class:"mb-4"},"Transactions",-1)),t("div",F,[d(t("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>a.search=n),onInput:e[1]||(e[1]=(...n)=>o.loadTransactions&&o.loadTransactions(...n)),type:"text",class:"form-control w-50",placeholder:"Search by user, reference, or status..."},null,544),[[c,a.search]]),t("button",{class:"btn btn-success",onClick:e[2]||(e[2]=n=>o.openTransactionModal())},"New Transaction")]),t("table",C,[e[9]||(e[9]=t("thead",{class:"table-dark"},[t("tr",null,[t("th",null,"ID"),t("th",null,"User"),t("th",null,"Payment Method"),t("th",null,"Amount"),t("th",null,"Currency"),t("th",null,"Status"),t("th",null,"Reference"),t("th",null,"Created At"),t("th",null,"Actions")])],-1)),t("tbody",null,[(i(!0),l(v,null,f(a.transactions,n=>(i(),l("tr",{key:n.id},[t("td",null,r(n.id),1),t("td",null,r(n.user?n.user.username:"Guest"),1),t("td",null,r(n.payment_method),1),t("td",null,r(o.formatCurrency(n.amount)),1),t("td",null,r(n.currency),1),t("td",null,[t("span",{class:h(o.statusClass(n.status))},r(n.status),3)]),t("td",null,r(n.reference||"-"),1),t("td",null,r(o.formatDate(n.created_at)),1),t("td",null,[t("button",{class:"btn btn-sm btn-info me-1",onClick:p=>o.viewTransaction(n)},"View",8,P),t("button",{class:"btn btn-sm btn-danger",onClick:p=>o.deleteTransaction(n.id)},"Delete",8,D)])]))),128)),a.transactions.length===0?(i(),l("tr",E,[...e[8]||(e[8]=[t("td",{colspan:"9",class:"text-center"},"No transactions found.",-1)])])):b("",!0)])]),t("div",S,[t("div",k,[t("div",I,[e[16]||(e[16]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"New Transaction"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),t("div",N,[t("form",{onSubmit:e[7]||(e[7]=T((...n)=>o.saveTransaction&&o.saveTransaction(...n),["prevent"]))},[t("div",X,[e[11]||(e[11]=t("label",{class:"form-label"},"Payment Method",-1)),d(t("select",{"onUpdate:modelValue":e[3]||(e[3]=n=>a.transactionForm.payment_method=n),class:"form-select",required:""},[...e[10]||(e[10]=[M('<option value="" disabled data-v-fceb1201>Select Payment</option><option value="AIRTEL" data-v-fceb1201>AirTel Money</option><option value="MTN" data-v-fceb1201>MTN Mobile Money</option><option value="PAYPAL" data-v-fceb1201>PayPal</option><option value="STRIPE" data-v-fceb1201>Stripe</option>',5)])],512),[[g,a.transactionForm.payment_method]])]),t("div",A,[e[12]||(e[12]=t("label",{class:"form-label"},"Amount",-1)),d(t("input",{"onUpdate:modelValue":e[4]||(e[4]=n=>a.transactionForm.amount=n),type:"number",class:"form-control",min:"0.01",step:"0.01",required:""},null,512),[[c,a.transactionForm.amount,void 0,{number:!0}]])]),o.requiresPhone?(i(),l("div",U,[e[13]||(e[13]=t("label",{class:"form-label"},"Phone Number",-1)),d(t("input",{"onUpdate:modelValue":e[5]||(e[5]=n=>a.transactionForm.phone_number=n),type:"text",class:"form-control",placeholder:"07XXXXXXXX",required:""},null,512),[[c,a.transactionForm.phone_number]])])):b("",!0),t("div",V,[e[14]||(e[14]=t("label",{class:"form-label"},"Currency",-1)),d(t("input",{"onUpdate:modelValue":e[6]||(e[6]=n=>a.transactionForm.currency=n),type:"text",class:"form-control",placeholder:"UGX",required:""},null,512),[[c,a.transactionForm.currency]])]),e[15]||(e[15]=t("button",{type:"submit",class:"btn btn-primary"},"Process Payment",-1))],32)])])])]),t("div",q,[t("div",B,[t("div",L,[e[17]||(e[17]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Transaction Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),t("div",G,[t("pre",null,r(a.selectedTransaction),1)])])])])])}const H=y(_,[["render",R],["__scopeId","data-v-fceb1201"]]);export{H as default};
